# Эффективные методы использования Кваса

**Квас** - это, прежде всего, оболочка вокруг уже существующих инструментов, это **CLI** инструмент для простой настройки выборочного использования уже имеющегося **VPN** соединения для индивидуального списка Ваших сайтов.

Безусловно, существуют [множество инструментов](https://forum.keenetic.com/topic/8106-выборочный-роутинг-через-vpn-туннель/?do=findComment&comment=155733), описанных на [форуме Keenetic](https://forum.keenetic.com)  для выполнения обозначенной задачи, которые состоят всего из нескольких скриптов, но моей основной целью написания **Кваса** выражается в концепции "**поставил и забыл**".

Благодаря обратной связи от пользователей **Кваса**, и благодаря своему опыту работы с пакетом, мое мнение по его эффективному использованию можно описать одной фразой "**чем проще - тем лучше**".

Другими словами, на своем устройстве, после многочисленных переустановок **AGuardHome** и разбирательств почему "**не**", пришел к простому пониманию, что лучше связки, чем та, которая стоит по умолчанию: **dnsmasq + dnscrypt-proxy2**, при установке пакета, ничего нет. В случае необходимости, можно еще дополнительно подключить **adblock** для блокировки рекламы и других пугающих ресурсов командой **kvas adblock on**. 

## Базовые процедуры 
1. Установка пакета: `curl -sOLJ http://kvas.zeleza.ru/upgrade && sh upgrade`
1. Обновление пакета: `curl -sOLJ http://kvas.zeleza.ru/upgrade && sh upgrade full`
1. Удаление пакета в ручном режиме: `kvas rm full`

## Последовательность добавления доменных имен для определенного сайта

1. Добавляем домен в Квас командой `kvas add domen.com`
1. Открываем браузер на клиенте и затем попытаться открыть сайт в самом браузере
1. В случае, если домен открывается, но не корректно (не так, как должен), то открываем режим "**Разработчика**" в браузере и смотрим на ошибки с номером **403** и далее последовательно добавляем все домены с такими ошибками в **Квас** вышесказанной командой. 

> ### Пример с **chat.openai.com** (добавлен в список **Кваса** по умолчанию* )
> 1. Добавляем в **Квас** все субдомены домена  **openai.com** командой: `kvas add openai.com` 
> 1. Заходим на сайт **chat.openai.com** и видим не отформатированный вид страницы.
> 1. Заходим в режим "**Разработчика**" в браузере в раздел "**Ошибки**" и видим, что множество **403** ошибок нам выдает всего один сайт **cdn.oaistatic.com**. Далее добавляем все субдомены этого домена в **Квас** командой `kvas add oaistatic.com`.

## Повторное сканирование **VPN** подключений
В случае, если Вы подключили какой либо **VPN** интерфейс и хотите его задействовать в Квасе, уже после его установки и настройки, то необходимо выполнить команду `kvas vpn scan`

## Подключение клиентов имеющейся WIFI сетей и VPN серверов (IKEv2)

Для подключения/отключения клиентов имеющейся **VPN** или **WIFI** сети к **VPN** тоннелю в **Квасе** предусмотрены следующие команды
1. Подключить сеть `kvas vpn net add`, где из списка выбираем нужную нам сеть для подключения.
1. Отключить сеть `kvas vpn net del`, где из списка выбираем нужную нам сеть для подключения.
1. Просмотр статусов сетей `kvas vpn net`.

## Тестирование и порой восстановление доступа можно осуществить тремя командами: 
1. `kvas update`
1. `kvas test`
1. `kvas debug`

Вот собственно все. Это самые востребованные команды из всех имеющихся в пакете.
С детальной справкой по командам Кваса Вы сможете ознакомиться на **Wiki** проекта [по этой ссылке](https://github.com/qzeleza/kvas/wiki/%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4).
